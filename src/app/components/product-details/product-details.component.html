<app-navbar></app-navbar>

<div class="product-details product-details-mobile">
  <!-- Background Yellow -->
  <div class="bg-yellow">
    <img src="/assets/BGs/BG_Yellow.svg" alt="Background" />
  </div>

  <app-loading
    *ngIf="isLoading"
    [fullScreen]="true"
    message="Carregando detalhes..."
  ></app-loading>

  <!-- Conteúdo principal -->
  <main class="main-content" *ngIf="product && !isLoading">
    <!-- Seção Esquerda: Recomendados + Seletor de Tamanho -->
    <div class="left-section">
      <!-- Painel de Recomendados -->
      <div class="recommendations-panel">
        <h3>Produtos Recomendados</h3>

        <!-- Produtos Recomendados (2 colunas) -->
        <div class="recommended-products">
          <div
            class="product-thumb"
            *ngFor="let recommended of recommendedProducts"
            (click)="switchProduct(recommended.id)"
            style="cursor: pointer"
          >
            <img [src]="recommended.imageSrc" [alt]="recommended.name" />
          </div>
        </div>
      </div>
    </div>

    <!-- Seção Central: Produto com BG -->
    <div class="center-section">
      <!-- Produto com Background -->
      <div class="product-display">
        <div class="product-bg">
          <img
            src="/assets/Section_Detalhes_Prod/bg_produto.webp"
            alt="Product Background"
          />
        </div>

        <!-- Nome do Produto (dentro do BG) -->
        <h1 class="product-name">{{ product.name }}</h1>

        <!-- Descrição do Produto (agora abaixo do título) -->
        <!-- Descrição do Produto (agora abaixo do título) -->
        <!-- Descrição removida conforme solicitado -->
        <!-- Imagem do Produto com animação de escala -->
        <div
          class="product-image"
          [style.transform]="
            'translate(-50%, -50%) scale(' + productScale + ')'
          "
        >
          <img [src]="product.imageSrc" [alt]="product.name" />
        </div>
      </div>
    </div>

    <!-- Seção Direita: Painel de Preço -->
    <div class="right-section">
      <div class="price-panel">
        <!-- Título -->
        <h3 class="size-title">Selecione o tamanho</h3>

        <!-- Seletor de Tamanho (SVG em 2 colunas) -->
        <div *ngIf="isVariantTenis; else singleSize">
          <div class="size-selector-grid">
            <div
              *ngFor="let size of shoeSizes"
              class="size-option"
              [class.selected]="size === selectedShoeSize"
              (click)="selectShoeSize(size)"
              style="cursor: pointer"
            >
              <img
                [src]="
                  '/assets/Section_Detalhes_Prod/numeros_tenis/' +
                  size +
                  '.webp'
                "
                [alt]="'Tamanho ' + size"
              />
            </div>
          </div>
        </div>
        <ng-template #singleSize>
          <img
            src="/assets/btn_assets/icons_tamanho_Bolas_Skates.webp"
            alt="Tamanho Único"
            class="single-size-icon"
          />
        </ng-template>

        <!-- Indicador de Estoque -->
        <div
          *ngIf="product.stock !== undefined"
          class="stock-indicator {{ getStockStatusClass() }}"
        >
          <span>{{ getStockMessage() }}</span>
        </div>

        <!-- Preço -->
        <p class="price">{{ product.price }}</p>

        <!-- Botão Adicionar ao Carrinho -->
        <div class="btn-add-sacola">
          <img
            [src]="'/assets/Section_Detalhes_Prod/btn_add_sacola.svg'"
            alt="Adicionar ao Carrinho"
            class="btn-add-cart"
            [class.clicked]="isAddedToCart"
            (click)="handleAddToCart()"
            style="cursor: pointer"
          />
        </div>
      </div>
    </div>
  </main>

  <!-- Nova Seção: Sobre o Produto -->
  <section class="about-product-section" *ngIf="product && !isLoading">
    <div class="about-container">
      <h2>Sobre o Produto</h2>
      <p class="about-description">
        {{
          product.description ||
            "Desenvolvido com tecnologia de ponta e materiais premium, este produto oferece conforto excepcional e design inovador. Perfeito para quem busca performance e estilo em cada passo."
        }}
      </p>
    </div>
  </section>

  <!-- Nova Seção: Avaliações -->
  <section
    class="reviews-section"
    *ngIf="
      product && !isLoading && product.reviews && product.reviews.length > 0
    "
  >
    <div class="reviews-container">
      <h2>Avaliações</h2>

      <div class="reviews-grid">
        <div class="review-card" *ngFor="let review of product.reviews">
          <div class="review-header">
            <span class="review-user">{{ review.userName }}</span>
            <div class="review-rating">
              <img
                *ngFor="let star of getStarArray(review.rating)"
                src="/assets/icons/star.png"
                alt="Star"
                class="star-icon"
              />
            </div>
          </div>
          <p class="review-comment">{{ review.comment }}</p>
          <span class="review-date">{{ review.date }}</span>
        </div>
      </div>
    </div>
  </section>
</div>
